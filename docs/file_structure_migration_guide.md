# 文件结构迁移指南

本文档详细说明了项目文件结构迁移的计划、步骤和注意事项，帮助开发团队顺利完成迁移工作。

## 迁移目标

将项目从原有的扁平结构调整为更有组织的层次结构，主要包括：

1. 创建 `src` 目录，将所有源代码文件移入其中
2. 按照功能和职责划分子目录
3. 统一引用路径和命名规范
4. 确保迁移过程中功能不受影响

## 迁移步骤

### 1. 创建新的目录结构 ✓

首先建立新的目录结构框架：

```
zhaohuAI_tools/
├── src/                     # 新的源码目录
│   ├── components/          # 组件目录
│   │   ├── common/          # 通用组件
│   │   └── business/        # 业务组件
│   ├── pages/               # 页面目录
│   ├── services/            # API 服务层
│   ├── utils/               # 工具函数
│   ├── constants/           # 常量定义
│   └── types/               # TypeScript 类型定义
├── config/                  # 配置文件目录
├── docs/                    # 文档目录
└── tests/                   # 测试文件目录
```

### 2. 迁移页面文件 ✓

将所有页面相关文件迁移到对应目录：

- 将根目录下的页面文件夹移动到 `src/pages/` 目录下
- 确保每个页面的 JS、WXML、WXSS、JSON 文件都一起迁移

### 3. 迁移组件文件 ✓

将组件文件迁移到对应目录：

- 将通用组件移动到 `src/components/common/` 目录
- 将业务组件移动到 `src/components/business/` 目录
- 重构组件的引用路径

### 4. 迁移工具函数和服务 ✓

将工具函数和服务相关代码迁移：

- 将工具函数移动到 `src/utils/` 目录
- 将 API 服务相关代码移动到 `src/services/` 目录
- 提取常量定义到 `src/constants/` 目录

### 5. 迁移静态资源 ✓

将静态资源移动到 `src/assets/` 目录：

- 将 `assets/icons/` 移动到 `src/assets/icons/`
- 将 `assets/styles/` 移动到 `src/assets/styles/`
- 更新所有引用这些资源的路径

### 6. 更新配置文件 ✓

更新小程序配置文件，使其适应新的目录结构：

- 修改 `project.config.json` 中的 `miniprogramRoot` 配置
- 更新 `app.json` 中的页面路径配置

### 7. 更新引用路径 ✓

全面审查并更新项目中的引用路径：

- 更新组件引用路径
- 更新工具函数引用路径
- 更新静态资源引用路径

## 迁移注意事项

### 已处理的问题

1. ✓ **路径引用问题**：所有引用路径已更新为相对于新结构的正确路径
2. ✓ **资源路径问题**：所有静态资源路径已更新为 `/src/assets/` 开头的路径
3. ✓ **配置文件调整**：小程序配置文件已更新以适应新结构
4. ✓ **组件引用错误**：组件路径引用已全部检查并修复
5. ✓ **临时文件处理**：临时文件已清理完毕

### 迁移验证清单

- ✓ 确认所有页面能正常加载
- ✓ 确认所有组件能正常渲染
- ✓ 确认所有静态资源能正常显示
- ✓ 确认所有API请求能正常发送
- ✓ 确认本地存储功能正常
- ✓ 确认页面跳转功能正常

## 回滚方案

如果迁移过程中遇到严重问题需要回滚，请按以下步骤操作：

1. 备份当前状态的代码
2. 恢复备份的上一个稳定版本
3. 在本地环境验证恢复的版本功能正常后再次发布

## 迁移完成后的工作

- ✓ 更新项目文档，反映新的目录结构
- ✓ 为开发团队提供新结构的使用指南
- ✓ 制定并实施新的代码规范
- ✓ 清理不再使用的文件和代码
- ✓ 创建新的分支，作为未来开发的基础

## 迁移进度记录

| 阶段 | 状态 | 完成日期 | 负责人 | 备注 |
|------|------|----------|--------|------|
| 创建目录结构 | 已完成 | 2023-03-25 | 开发团队 | 建立基础目录结构 |
| 迁移页面文件 | 已完成 | 2023-03-26 | 开发团队 | 所有页面迁移完成 |
| 迁移组件文件 | 已完成 | 2023-03-26 | 开发团队 | 所有组件迁移完成 |
| 迁移工具和服务 | 已完成 | 2023-03-27 | 开发团队 | 工具函数和服务迁移完成 |
| 迁移静态资源 | 已完成 | 2023-03-28 | 开发团队 | 静态资源迁移完成 |
| 更新配置文件 | 已完成 | 2023-03-28 | 开发团队 | 配置文件更新完成 |
| 路径更新和验证 | 已完成 | 2023-03-28 | 开发团队 | 全面检查和更新引用路径 |

## 结论

项目文件结构迁移已全部完成，所有功能已通过验证，新的文件结构提供了更好的代码组织和可维护性。开发团队应参考《新文件结构说明》和《引用路径更新说明》等文档，了解新结构的详细设计和使用规范。 